<div><style type="text/css">[data-name=xaxis]{font-size:.8em}[data-name=yaxis]{font-size:.8em}.pdl-layout>div[data-type=layout]{display:grid;grid-template-columns:fit-content(2em) 1fr fit-content(10em);grid-template-rows:1fr fit-content(1em);padding:0 .5em}.pdl-layout>div[data-type=layout]>.pdl-cell[data-name=legend]{grid-column:3;grid-row:1/span 2;padding-left:1em}.pdl-layout.legend-bottom>div[data-type=layout]{grid-template-columns:2em 1fr;grid-template-rows:1fr fit-content(2em) fit-content(3em)}.pdl-layout.legend-bottom>div[data-type=layout] .pdl-cell[data-name=legend]{padding-top:1em;grid-column:1/span 2;grid-row:3}.pdl-layout.xaxis-center>div[data-type=layout]{grid-template-columns:fit-content(2em) 1fr fit-content(10em);grid-template-rows:1fr;grid-template-areas:"r1c1 r1c2 r1c3"}.pdl-layout.xaxis-center>div[data-type=layout] .pdl-cell[data-name=view]{grid-area:r1c2}.pdl-layout.xaxis-center>div[data-type=layout] .pdl-cell[data-name=legend]{grid-area:r1c3}.pdl-layout.xaxis-center>div[data-type=layout] .pdl-cell[data-name=yaxis]{grid-area:r1c1}.pdl-layout.xaxis-center>div[data-type=layout] .pdl-cell[data-name=xaxis]{grid-area:r1c2}.pdl-layout.yaxis-center>div[data-type=layout]{grid-template-columns:1fr fit-content(10em);grid-template-rows:1fr fit-content(3em);grid-template-areas:"r1c1 r1c2" "r2c1 r1c2"}.pdl-layout.yaxis-center>div[data-type=layout] .pdl-cell[data-name=view]{grid-area:r1c1}.pdl-layout.yaxis-center>div[data-type=layout] .pdl-cell[data-name=legend]{grid-area:r1c2}.pdl-layout.yaxis-center>div[data-type=layout] .pdl-cell[data-name=yaxis]{grid-area:r1c1}.pdl-layout.yaxis-center>div[data-type=layout] .pdl-cell[data-name=xaxis]{grid-area:r2c1}.pdl-layout.xaxis-center.legend-bottom>div[data-type=layout]{grid-template-columns:fit-content(2em) 1fr;grid-template-rows:1fr fit-content(3em);grid-template-areas:"r1c1 r1c2" "r2c1 r2c2"}.pdl-layout.xaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=view]{grid-area:r1c2}.pdl-layout.xaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=legend]{grid-area:r2c2}.pdl-layout.xaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=yaxis]{grid-area:r1c1}.pdl-layout.xaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=xaxis]{grid-area:r1c2}.pdl-layout.yaxis-center.legend-bottom>div[data-type=layout]{grid-template-columns:1fr;grid-template-rows:1fr fit-content(2em) fit-content(3em);grid-template-areas:"r1c1" "r2c1" "r3c1"}.pdl-layout.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=view]{grid-area:r1c1}.pdl-layout.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=legend]{grid-area:r3c1}.pdl-layout.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=yaxis]{grid-area:r1c1}.pdl-layout.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=xaxis]{grid-area:r2c1}.pdl-layout.xaxis-center.yaxis-center>div[data-type=layout]{grid-template-columns:1fr fit-content(10em);grid-template-rows:1fr;grid-template-areas:"r1c1 r1c2"}.pdl-layout.xaxis-center.yaxis-center>div[data-type=layout] .pdl-cell[data-name=view]{grid-area:r1c1}.pdl-layout.xaxis-center.yaxis-center>div[data-type=layout] .pdl-cell[data-name=legend]{grid-area:r1c2}.pdl-layout.xaxis-center.yaxis-center>div[data-type=layout] .pdl-cell[data-name=yaxis]{grid-area:r1c1}.pdl-layout.xaxis-center.yaxis-center>div[data-type=layout] .pdl-cell[data-name=xaxis]{grid-area:r1c1}.pdl-layout.xaxis-center.yaxis-center.legend-bottom>div[data-type=layout]{grid-template-columns:1fr;grid-template-rows:1fr fit-content(3em);grid-template-areas:"r1c1" "r2c1"}.pdl-layout.xaxis-center.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=view]{grid-area:r1c1}.pdl-layout.xaxis-center.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=legend]{grid-area:r2c1}.pdl-layout.xaxis-center.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=yaxis]{grid-area:r1c1}.pdl-layout.xaxis-center.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=xaxis]{grid-area:r1c1}.pdl-layout.xaxis-center .pdl-cell[data-name=xaxis]{position:absolute;inset:0;margin:auto;height:fit-content}.pdl-layout.yaxis-center .pdl-cell[data-name=yaxis]{position:absolute;inset:0;margin:auto;width:fit-content}</style><script type="@plotdb/block">var _corr,mod;module.exports={pkg:{extend:{name:"@makechart/base"},dependencies:[]},init:function(t){var e,r,i,n;e=t.root,r=t.context,i=t.t,n=t.pubsub;return n.fire("init",{mod:mod({context:r,t:i})})}};_corr=function(t){var e,i,n,a,r,s,o,u,c,d,l,f;e=[t.map(function(t){return t.x}),t.map(function(t){return t.y})],i=e[0],n=e[1];if((a=i.length)<=0){return[0,0]}r=i.reduce(function(t,e){return t+e},0);s=n.reduce(function(t,e){return t+e},0);o=i.reduce(function(t,e){return t+e*e},0);u=n.reduce(function(t,e){return t+e*e},0);c=function(){var t,e,r=[];for(t=0,e=a;t<e;++t){d=t;r.push(i[d]*n[d])}return r}().reduce(function(t,e){return t+e},0);l=c-r*s/a;f=o-r*r/a;if(!f){return[0,0]}return[(s*o/a-r*c/a)/f,l/f]};mod=function(t){var e,r,i,x,n;e=t.context,r=t.t;i=e.chart,x=e.d3,n=e.debounce;return{sample:function(){return{raw:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30].map(function(t){return{name:"Node "+t,x:Math.round(Math.random()*100),y:Math.round(Math.random()*100),s:Math.round(Math.random()*10)+5,c:["Apple","Banana","Peach","Melon","Orange"][Math.floor(Math.random()*5)],o:t}}),binding:{x:{key:"x",unit:"KM"},y:{key:"y",unit:"KG"},size:{key:"s",unit:"Days"},cat:{key:"c"},name:{key:"name"},order:{key:"o"}}}},config:import$(import$({legend:import$({},i.utils.config.preset.legend),tip:import$({},i.utils.config.preset.tip),xaxis:JSON.parse(JSON.stringify(i.utils.config.preset.axis)),yaxis:JSON.parse(JSON.stringify(i.utils.config.preset.axis))},i.utils.config.preset["default"]),{dot:{maxRadius:{type:"number",default:10,min:.1,max:100,step:.1},opacity:{type:"number",default:.75,min:0,max:1,step:.01},stroke:{type:"color",default:"#000"},strokeWidth:{type:"number",default:1,min:0,max:100,step:.5}},trend:{enabled:{type:"boolean",default:false},stroke:{type:"color",default:"rgba(0,0,0,.3)"},strokeWidth:{type:"number",default:1,min:0,max:100,step:.5},strokeDasharray:{type:"text",default:"5 5"},opacity:{type:"number",default:.5,min:0,max:1,step:.01},mode:{type:"choice",values:["curve","linear"],default:"linear"},cap:{type:"choice",values:["butt","round","square"],default:"round"},join:{type:"choice",values:["bevel","miter","round"],default:"round"}},regression:{enabled:{type:"boolean",default:true},stroke:{type:"color",default:"#000"},strokeWidth:{type:"number",default:1,min:0,max:100,step:.5},strokeDasharray:{type:"text",default:"5 5"},opacity:{type:"number",default:.5,min:0,max:1,step:.01}}}),dimension:{name:{type:"NC",name:"name"},cat:{type:"C",name:"category"},size:{type:"R",name:"size"},x:{type:"R",name:"X coordinate"},y:{type:"R",name:"Y coordinate"},order:{type:"O",name:"Order"}},init:function(){var e,t,n=this;this.tint=e=new i.utils.tint;this.g=Object.fromEntries(["view","xaxis","yaxis","legend"].map(function(t){return[t,x.select(n.layout.getGroup(t))]}));this.regression=this.g.view.append("line").attr("opacity",0).attr("class","regression");this.trend=this.g.view.append("path").attr("opacity",0).attr("class","trend");this.trendAni=this.trend.append("animate").attr("attributeName","stroke-dashoffset").attr("repeatCount","indefinite").attr("dur","1s").attr("values","0;1").attr("times","0;1");this.scale=t={};this.yaxis=new i.utils.axis({layout:this.layout,name:"yaxis",direction:"left"});this.xaxis=new i.utils.axis({layout:this.layout,name:"xaxis",direction:"bottom"});this.line=x.line().defined(function(t){return!(isNaN(t.y)||isNaN(t.x))}).x(function(t){return n.scale.x(t.x)}).y(function(t){return n.scale.y(t.y)});this.legend=new i.utils.legend({layout:this.layout,name:"legend",root:this.root,shape:function(t){return x.select(this).attr("fill",e.get(t.key))}});this.legend.on("select",function(){n.bind();n.resize();return n.render()});return this.tip=new i.utils.tip({root:this.root,accessor:function(t){var e,r,i;e=t.evt;if(!(e.target&&(r=x.select(e.target).datum()))){return null}i=isNaN(r.size)?"-":x.format(n.cfg.tip.format||".3s")(r.size)+""+(((n.binding||{}).size||{}).unit||"");return{name:[r.cat!=null?r.cat+" / ":"",r.name||"",r.order?" / "+r.order:""].join(""),value:i}},range:function(){return n.layout.getNode("view").getBoundingClientRect()}})},destroy:function(){if(this.tip){return this.tip.destroy()}},parse:function(){return this.data.map(function(t){t.size=isNaN(t.size)?0:t.size;t.x=isNaN(t.x)?0:t.x;return t.y=isNaN(t.y)?0:t.y})},resize:function(){var t,e,f,r,i,n,y=this,a=[];this.tint.set(this.cfg.palette);this.tip.toggle(((t=this.cfg).tip||(t.tip={})).enabled!=null?this.cfg.tip.enabled:true);this.line.curve(this.cfg.trend.mode==="curve"?x.curveCatmullRom:x.curveLinear);this.root.querySelector(".pdl-layout").classList.toggle("legend-bottom",this.cfg.legend.position==="bottom");this.root.querySelector(".pdl-layout").classList.toggle("xaxis-center",this.cfg.xaxis.center===true);this.root.querySelector(".pdl-layout").classList.toggle("yaxis-center",this.cfg.yaxis.center===true);this.legend.config(this.cfg.legend);e=!this.binding.cat?[]:Array.from(new Set(this.data.map(function(t){return t.cat}))).map(function(t){return{key:t,text:t}});this.legend.data(e);this.layout.update(false);f={y:x.extent(this.data.map(function(t){return t.y})),x:x.extent(this.data.map(function(t){return t.x})),s:x.extent(this.data.map(function(t){return t.size}))};r=function(){var t,e,r,i,n,a,s,o,u,c,d,l;y.layout.update(false);t=y.layout.getBox("view");e=y.cfg.dot.maxRadius*t.width*.2/100;r=e+y.cfg.dot.strokeWidth;y.scale.s=x.scaleSqrt().domain(f.s).range([0,e]);y.scale.y=x.scaleLinear().domain(f.y).range([t.height-r,r]);i=(n=Math.ceil(y.layout.getBox("yaxis").height/16))>2?n:2;a=y.scale.y.ticks((n=((s=y.cfg).xaxis||(s.xaxis={})).tick.count||4)<i?n:i);o=y.binding.y||{};y.yaxis.config(y.cfg.yaxis);y.yaxis.ticks(a);y.yaxis.scale(y.scale.y);u=y.cfg.yaxis.caption.text||o.name||o.key||"";if(o.unit){u+="("+o.unit+")"}y.yaxis.caption(u);y.yaxis.render();y.scale.x=x.scaleLinear().domain(f.x).range([r,t.width-r]);i=(n=Math.ceil(y.layout.getBox("xaxis").width/80))>2?n:2;c=y.scale.x.ticks((n=((s=y.cfg).xaxis||(s.xaxis={})).tick.count||4)<i?n:i);d=y.binding.x||{};y.xaxis.config(y.cfg.xaxis);y.xaxis.ticks(c);y.xaxis.scale(y.scale.x);l=y.cfg.xaxis.caption.text||d.name||d.key||"";if(d.unit){l+="("+d.unit+")"}y.xaxis.caption(l);return y.xaxis.render()};for(i=0;i<2;++i){n=i;a.push(r())}return a},render:function(){var t,e,r,i,n,a,s,o,u,c,d,l,f,y,x,h,p;t=this.data,e=this.line,r=this.binding,i=this.scale,n=this.tint,a=this.legend,s=this.cfg;o=this.g.view.selectAll("circle.data").data(this.data);o.exit().remove();o.enter().append("circle").attr("class","data").attr("r",0).attr("cx",function(t){return i.x(t.x)}).attr("cy",function(t){return i.y(t.y)}).attr("fill",function(t){return n.get(t.cat!=null?t.cat:"")}).attr("stroke",function(t){return s.dot.stroke}).attr("strokeWidth",function(t){return s.dot.strokeWidth});this.g.view.selectAll("circle.data").transition().duration(350).attr("r",function(t){var e;if(r.size!=null){return(e=i.s(t.size))>1?e:1}else{return(e=s.dot.maxRadius/2)>1?e:1}}).attr("cx",function(t){return i.x(t.x)}).attr("cy",function(t){return i.y(t.y)}).attr("fill",function(t){return n.get(t.cat!=null?t.cat:"")}).attr("opacity",function(t){var e;if(!(r.cat!=null)||a.isSelected(t.cat)){return(e=s.dot.opacity)>.1?e:.1}else{return.1<(e=s.dot.opacity/2)?.1:e}}).attr("stroke",function(t){return s.dot.stroke}).attr("stroke-width",function(t){return s.dot.strokeWidth});u=_corr(this.data.filter(function(t,e){return!(r.cat!=null)||a.isSelected(t.cat)}));c=i.x.domain(),d=c[0],l=c[1];c=[d,l].map(function(t){return t*u[1]+u[0]}),f=c[0],y=c[1];if(f<i.y.domain()[0]){f=i.y.domain()[0];d=(f-u[0])/(u[1]||1)}if(y>i.y.domain()[1]){y=i.y.domain()[1];l=(y-u[0])/(u[1]||1)}c=[i.x(d),i.x(l),i.y(f),i.y(y)],d=c[0],l=c[1],f=c[2],y=c[3];x=isNaN(d)||isNaN(l)||isNaN(f)||isNaN(y)||!(u[0]||u[1])||!s.regression.enabled;this.regression.transition("regression").duration(350).attr("x1",x?0:d).attr("x2",x?0:l).attr("y1",x?0:f).attr("y2",x?0:y).attr("opacity",x?0:s.regression.opacity).attr("stroke",s.regression.stroke).attr("stroke-width",s.regression.strokeWidth).attr("stroke-dasharray",s.regression.strokeDasharray);h=t.map(function(t){return{x:t.x,y:t.y,order:t.order}});h.sort(function(t,e){if(t.order<e.order){return-1}else if(t.o>e.o){return 1}else{return 0}});this.trend.attr("d",function(){return e(h)}).attr("fill","none").attr("opacity",s.trend.enabled?1:0).attr("stroke",s.trend.stroke).attr("stroke-width",s.trend.strokeWidth).attr("stroke-dasharray",s.trend.strokeDasharray).attr("stroke-linecap",s.trend.cap).attr("stroke-linejoin",s.trend.join);p=s.trend.strokeDasharray.split(" ").filter(function(t){return t!=null}).reduce(function(t,e){return t+ +e},0);this.trendAni.attr("values",p+";0");this.legend.render();this.yaxis.render();return this.xaxis.render()}}};function import$(t,e){var r={}.hasOwnProperty;for(var i in e)if(r.call(e,i))t[i]=e[i];return t}</script><div plug="layout"><div class="pdl-layout"><div data-type="layout"><div class="pdl-cell" data-name="yaxis">&nbsp;</div><div class="pdl-cell" data-name="view"></div><div class="pdl-cell"></div><div class="pdl-cell" data-name="xaxis">&nbsp;</div><div class="pdl-cell" data-name="legend">&nbsp;</div></div><div data-type="render"></div></div></div></div>