<div><style type="text/css">[data-name=xaxis]{font-size:.8em}[data-name=yaxis]{font-size:.8em}.pdl-layout>div[data-type=layout]{display:grid;grid-template-columns:fit-content(2em) 1fr fit-content(10em);grid-template-rows:1fr fit-content(1em);padding:0 .5em}.pdl-layout>div[data-type=layout]>.pdl-cell[data-name=legend]{grid-column:3;grid-row:1/span 2;padding-left:1em}.pdl-layout.legend-bottom>div[data-type=layout]{grid-template-columns:2em 1fr;grid-template-rows:1fr fit-content(2em) fit-content(3em)}.pdl-layout.legend-bottom>div[data-type=layout] .pdl-cell[data-name=legend]{padding-top:1em;grid-column:1/span 2;grid-row:3}.pdl-layout.xaxis-center>div[data-type=layout]{grid-template-columns:fit-content(2em) 1fr fit-content(10em);grid-template-rows:1fr;grid-template-areas:"r1c1 r1c2 r1c3"}.pdl-layout.xaxis-center>div[data-type=layout] .pdl-cell[data-name=view]{grid-area:r1c2}.pdl-layout.xaxis-center>div[data-type=layout] .pdl-cell[data-name=legend]{grid-area:r1c3}.pdl-layout.xaxis-center>div[data-type=layout] .pdl-cell[data-name=yaxis]{grid-area:r1c1}.pdl-layout.xaxis-center>div[data-type=layout] .pdl-cell[data-name=xaxis]{grid-area:r1c2}.pdl-layout.yaxis-center>div[data-type=layout]{grid-template-columns:1fr fit-content(10em);grid-template-rows:1fr fit-content(3em);grid-template-areas:"r1c1 r1c2" "r2c1 r1c2"}.pdl-layout.yaxis-center>div[data-type=layout] .pdl-cell[data-name=view]{grid-area:r1c1}.pdl-layout.yaxis-center>div[data-type=layout] .pdl-cell[data-name=legend]{grid-area:r1c2}.pdl-layout.yaxis-center>div[data-type=layout] .pdl-cell[data-name=yaxis]{grid-area:r1c1}.pdl-layout.yaxis-center>div[data-type=layout] .pdl-cell[data-name=xaxis]{grid-area:r2c1}.pdl-layout.xaxis-center.legend-bottom>div[data-type=layout]{grid-template-columns:fit-content(2em) 1fr;grid-template-rows:1fr fit-content(3em);grid-template-areas:"r1c1 r1c2" "r2c1 r2c2"}.pdl-layout.xaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=view]{grid-area:r1c2}.pdl-layout.xaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=legend]{grid-area:r2c2}.pdl-layout.xaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=yaxis]{grid-area:r1c1}.pdl-layout.xaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=xaxis]{grid-area:r1c2}.pdl-layout.yaxis-center.legend-bottom>div[data-type=layout]{grid-template-columns:1fr;grid-template-rows:1fr fit-content(2em) fit-content(3em);grid-template-areas:"r1c1" "r2c1" "r3c1"}.pdl-layout.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=view]{grid-area:r1c1}.pdl-layout.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=legend]{grid-area:r3c1}.pdl-layout.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=yaxis]{grid-area:r1c1}.pdl-layout.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=xaxis]{grid-area:r2c1}.pdl-layout.xaxis-center.yaxis-center>div[data-type=layout]{grid-template-columns:1fr fit-content(10em);grid-template-rows:1fr;grid-template-areas:"r1c1 r1c2"}.pdl-layout.xaxis-center.yaxis-center>div[data-type=layout] .pdl-cell[data-name=view]{grid-area:r1c1}.pdl-layout.xaxis-center.yaxis-center>div[data-type=layout] .pdl-cell[data-name=legend]{grid-area:r1c2}.pdl-layout.xaxis-center.yaxis-center>div[data-type=layout] .pdl-cell[data-name=yaxis]{grid-area:r1c1}.pdl-layout.xaxis-center.yaxis-center>div[data-type=layout] .pdl-cell[data-name=xaxis]{grid-area:r1c1}.pdl-layout.xaxis-center.yaxis-center.legend-bottom>div[data-type=layout]{grid-template-columns:1fr;grid-template-rows:1fr fit-content(3em);grid-template-areas:"r1c1" "r2c1"}.pdl-layout.xaxis-center.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=view]{grid-area:r1c1}.pdl-layout.xaxis-center.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=legend]{grid-area:r2c1}.pdl-layout.xaxis-center.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=yaxis]{grid-area:r1c1}.pdl-layout.xaxis-center.yaxis-center.legend-bottom>div[data-type=layout] .pdl-cell[data-name=xaxis]{grid-area:r1c1}.pdl-layout.xaxis-center .pdl-cell[data-name=xaxis]{position:absolute;inset:0;margin:auto;height:fit-content}.pdl-layout.yaxis-center .pdl-cell[data-name=yaxis]{position:absolute;inset:0;margin:auto;width:fit-content}</style><script type="@plotdb/block">var scalePr,slice$=[].slice,arrayFrom$=Array.from||function(n){return slice$.call(n)};scalePr=function(n){var f,o,s,m,p,v,d,r,u,e;n==null&&(n={});f=[];o=[0,1];s=n.clamp!=null?!!n.clamp:false;m=[];p=[];v=[];d=0;r=function(){var r,n,e,t,l,u,i;if(!(f!=null&&f.length>0)){m=[];p=[];v=[];d=0;return}r=new Map;for(n=0,t=(e=f).length;n<t;++n){l=e[n];r.set(l,(r.get(l)||0)+1)}m=arrayFrom$(r.keys()).sort(function(n,r){return n-r});p=m.map(function(n){return r.get(n)});v=[];u=0;for(n=0,t=p.length;n<t;++n){i=p[n];u+=i;v.push(u)}return d=u};u=function(n){var r,e,t,l,u,i,f,o,a,c,h,g;if(m.length===0){return 0}if(d<=1){return 0}r=0;e=m.length-1;while(r<=e){t=r+e>>>1;if(m[t]<n){r=t+1}else{e=t-1}}l=r;u=m[l]===n?v[l]-1:l===0?m.length<2?0:(i=m[0],f=m[1],o=0,a=p[0],c=(a-o)/(f-i),o+(n-i)*c):l>=m.length?(i=m[m.length-2],f=m[m.length-1],o=v[m.length-2]-1,a=v[m.length-1]-1,c=(a-o)/(f-i),a+(n-f)*c):(i=m[l-1],f=m[l],o=v[l-1]-1,a=v[l]-1,h=(n-i)/(f-i),o+(a-o)*h);g=u/(d-1)*100;if(s){if(g<0){g=0}if(g>100){g=100}}return g};e=function(n){var r,e,t,l;r=u(n);e=r/100;t=o[0];l=o[1];return t*(1-e)+l*e};e.invert=function(n){var r,e,t,l,u,i,f;if(m.length===0){return undefined}r=o[0];e=o[1];if(r===e){return m[0]}t=(n-r)/(e-r);if(s){if(t<0){t=0}if(t>1){t=1}}l=t*(d-1);for(u=0,i=v.length;u<i;++u){f=u;if(v[f]>l){return m[f]}}return m[m.length-1]};e.domain=function(n){if(n==null){return f}f=n.slice();r();return e};e.range=function(n){if(n==null){return o}o=n.slice();return e};e.clamp=function(n){if(n==null){return s}s=!!n;return e};e.ticks=function(n){var r,e,t,l,u,i,f,o,a;n==null&&(n=10);if(m.length===0){return[]}r=m[0];e=m[m.length-1];if(r===e){return[r]}t=e-r;l=Math.pow(10,Math.floor(Math.log10(t/n)));u=n/(t/l);if(u>=9.5){l*=10}else if(u>=4.5){l*=5}else if(u>=1.9){l*=2}i=Math.ceil(r/l)*l;f=Math.floor(e/l)*l;o=[];a=i;while(a<=f){o.push(a);a+=l}return o};e._debug=function(){return{sorted:m,counts:p,cumulative:v,total:d,doClamp:s}};return e};module.exports=scalePr;var getLabelForce,_corr,mod;getLabelForce=function(y){var u,W,t;u=function(t,e,r){if(t<e){return e}else if(t>r){return r}else{return t}};W=function(t,e,r){var a,n,i,s,o,l;a=(r.w||0)/2;n=(r.h||0)/2;i=r.x-a;s=r.x+a;o=r.y-n;l=r.y+n;return[u(t,i,s),u(e,o,l)]};t=function(t){var v,b,k,w,M,N,z,A,n,i,l,u,p,g,m,R,S,c,e,s,o,d,f,h,r;t==null&&(t={});v=t.getPx||function(t){return t.data.px};b=t.getPy||function(t){return t.data.py};k=t.getPr||function(t){return t.data.radius};w=t.bandMargin||5;M=t.rectPad||2;N=t.circlePad||0;z=t.kBand||.35;A=t.kCollide||.7;n=t.itRect||2;i=t.itCircle||1;l=t.kAlignx||.12;u=t.alignDeadband||1;p=t.canvasW||800;g=t.canvasH||600;m=t.boundsPad||0;R=t.kBounds||.9;S=null;c=null;e=function(){var n;return c=function(){var t,e,r,a=[];for(t=0,r=(e=S).length;t<r;++t){n=e[t];a.push({x:+v(n),y:+b(n),r:+k(n)})}return a}()};s=function(t){var e,r,a,n,i,s,o,l,u,c,d,f,h,y,x,p,g=[];for(e=0,a=(r=S).length;e<a;++e){n=r[e];i=+v(n);s=+b(n);o=+k(n);l=o+w;u=W(i,s,n),c=u[0],d=u[1];f=c-i;h=d-s;y=Math.hypot(f,h);if(y===0){x=[[Math.abs(n.x-n.w/2-i),n.x-n.w/2-l,n.y],[Math.abs(n.x+n.w/2-i),n.x+n.w/2+l,n.y],[Math.abs(n.y-n.h/2-s),n.x,n.y-n.h/2-l],[Math.abs(n.y+n.h/2-s),n.x,n.y+n.h/2+l]];x.sort(m);f=x[0][1]-i;h=x[0][2]-s;y=Math.hypot(f,h)}if(y<=l){p=(l-y)/y*(z*t);n.vx=(n.vx||0)+f*p;g.push(n.vy=(n.vy||0)+h*p)}else if(y>l){p=(y-l)/y*(z*t);n.vx=(n.vx||0)-f*p;g.push(n.vy=(n.vy||0)-h*p)}}return g;function m(t,e){if(t[0]<e[0]){return-1}else if(t[0]>e[0]){return 1}else{return 0}}};o=function(t){var e,r,a,n,i,s,o=[];if(!(l>0)){return}for(e=0,a=(r=S).length;e<a;++e){n=r[e];i=+v(n);s=i-n.x;if(Math.abs(s)>u){o.push(n.vx=(n.vx||0)+s*l*t)}}return o};d=function(x){var t,e,r,a,p,g,m,v,b,k,w,n=[];t=y.quadtree().x(function(t){return t.x}).y(function(t){return t.y}).addAll(S);for(e=0,a=(r=S).length;e<a;++e){p=r[e];g=(p.w||0)/2+M;m=(p.h||0)/2+M;v=p.x-(g+200);b=p.y-(m+200);k=p.x+(g+200);w=p.y+(m+200);n.push(t.visit(i))}return n;function i(t,e,r,a,n){var i,s,o,l,u,c,d,f,h,y;i=t.data;if(i!=null&&i!==p){s=(i.w||0)/2+M;o=(i.h||0)/2+M;l=i.x-p.x;u=i.y-p.y;if(Math.abs(l)<g+s&&Math.abs(u)<m+o){c=g+s-Math.abs(l);d=m+o-Math.abs(u);if(c<d){f=l>=0?1:-1;h=c*f;y=A*x*.5;p.vx=(p.vx||0)-h*y;i.vx=(i.vx||0)+h*y}else{f=u>=0?1:-1;h=d*f;y=A*x*.5;p.vy=(p.vy||0)-h*y;i.vy=(i.vy||0)+h*y}}}return e>k||a<v||r>w||n<b}};f=function(x){var t,e,r,a,p,n,i,g,m,v,b,s=[];t=y.quadtree().x(function(t){return t.x}).y(function(t){return t.y}).addAll(c);for(e=0,a=(r=S).length;e<a;++e){p=r[e];n=(p.w||0)/2;i=(p.h||0)/2;g=p.x-(n+300);m=p.y-(i+300);v=p.x+(n+300);b=p.y+(i+300);s.push(t.visit(o))}return s;function o(t,e,r,a,n){var i,s,o,l,u,c,d,f,h,y;i=t.data;if(i!=null){s=W(i.x,i.y,p),o=s[0],l=s[1];u=o-i.x;c=l-i.y;d=Math.hypot(u,c);f=i.r+N;if(d<f){if(d===0){u=p.x-i.x;c=p.y-i.y;if(u===0&&c===0){u=(Math.random()-.5)*1e-6;c=(Math.random()-.5)*1e-6}d=Math.hypot(u,c)}h=f-d;y=A*x;p.vx=(p.vx||0)+u/d*h*y;p.vy=(p.vy||0)+c/d*h*y}}return e>v||a<g||r>b||n<m}};h=function(t){var e,r,a,n,i,s,o,l,u,c,d,f,h,y,x=[];e=m;r=m;a=p-m;n=g-m;for(i=0,o=(s=S).length;i<o;++i){l=s[i];u=(l.w||0)/2;c=(l.h||0)/2;d=l.x-u-e;if(d<0){l.vx=(l.vx||0)-d*R*t}f=l.x+u-a;if(f>0){l.vx=(l.vx||0)-f*R*t}h=l.y-c-r;if(h<0){l.vy=(l.vy||0)-h*R*t}y=l.y+c-n;if(y>0){x.push(l.vy=(l.vy||0)-y*R*t)}}return x};r=function(t){var e,r,a;if(!(S!=null&&S.length)){return}s(t);o(t);for(e=0,r=n;e<r;++e){a=e;d(t)}for(e=0,r=i;e<r;++e){a=e;f(t)}h(t)};r.initialize=function(t){S=t;e()};r.updateCircles=function(){e();return r};return r};return t};module.exports={pkg:{extend:{name:"@makechart/base"},dependencies:[]},init:function(t){var e,r,a,n;e=t.root,r=t.context,a=t.t,n=t.pubsub;return n.fire("init",{mod:mod({context:r,t:a})})}};_corr=function(t){var e,a,n,i,r,s,o,l,u,c,d,f;e=[t.map(function(t){return t.x}),t.map(function(t){return t.y})],a=e[0],n=e[1];if((i=a.length)<=0){return[0,0]}r=a.reduce(function(t,e){return t+e},0);s=n.reduce(function(t,e){return t+e},0);o=a.reduce(function(t,e){return t+e*e},0);l=n.reduce(function(t,e){return t+e*e},0);u=function(){var t,e,r=[];for(t=0,e=i;t<e;++t){c=t;r.push(a[c]*n[c])}return r}().reduce(function(t,e){return t+e},0);d=u-r*s/i;f=o-r*r/i;if(!f){return[0,0]}return[(s*o/i-r*u/i)/f,d/f]};mod=function(t){var e,r,s,g,a;e=t.context,r=t.t;s=e.chart,g=e.d3,a=e.debounce;return{sample:function(){return{raw:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300].map(function(t){var e,r,a;e=Math.floor(Math.random()*5);r=[[0,100,0,100,3,3],[50,50,50,50,7,2],[30,20,60,40,2,3],[80,20,30,30,2,2],[30,10,30,10,3,4]];a={x:Math.round(Math.random()*r[e][0]+r[e][1]),y:Math.round(Math.random()*r[e][2]+r[e][3]),s:Math.round(Math.random()*r[e][4]+r[e][5])};return a.name="Node "+t,a.c=["Apple","Banana","Peach","Melon","Orange"][e],a.o=t,a}),binding:{x:{key:"x",unit:"KM"},y:{key:"y",unit:"KG"},size:{key:"s",unit:"Days"},cat:{key:"c"},name:{key:"name"},order:{key:"o"}}}},config:import$(import$({legend:import$({},s.utils.config.preset.legend),tip:import$({},s.utils.config.preset.tip),xaxis:import$(JSON.parse(JSON.stringify(s.utils.config.preset.axis)),{scale:{type:"choice",defalut:"linear",values:[{name:"Linear",value:"linear"},{name:"Percentile Rank",value:"pr"},{name:"Log Scale",value:"log"}]},grid:{enabled:{type:"boolean",default:false},color:{type:"color",default:"rgba(0,0,0,0.1)"},strokeWidth:{type:"number",default:1,min:0,max:10,step:.5},strokeDasharray:{type:"text",default:""}}}),yaxis:import$(JSON.parse(JSON.stringify(s.utils.config.preset.axis)),{scale:{type:"choice",defalut:"linear",values:[{name:"Linear",value:"linear"},{name:"PR",value:"pr"},{name:"Log Scale",value:"log"}]},grid:{enabled:{type:"boolean",default:false},color:{type:"color",default:"rgba(0,0,0,0.1)"},strokeWidth:{type:"number",default:1,min:0,max:10,step:.5},strokeDasharray:{type:"text",default:""}}})},s.utils.config.preset["default"]),{alignRange:{name:"align data range",type:"boolean",default:false},dot:{minRadius:{name:"min radius",type:"number",default:1,min:0,max:100,step:.1},maxRadius:{name:"max radius",type:"number",default:6,min:.1,max:100,step:.1},opacity:{type:"number",default:.75,min:0,max:1,step:.01},stroke:{type:"color",default:"#000"},strokeWidth:{type:"number",default:1,min:0,max:100,step:.5}},label:{enabled:{type:"boolean",default:false},font:import$({},s.utils.config.preset.font),cap:{type:"quantity",default:"100p",units:[{name:"﹪",max:100,min:0,step:1,default:10},{name:"pts",step:1,default:100}]}},trend:{enabled:{type:"boolean",default:false},stroke:{type:"color",default:"rgba(0,0,0,.3)"},strokeWidth:{type:"number",default:1,min:0,max:100,step:.5},strokeDasharray:{type:"text",default:"5 5"},opacity:{type:"number",default:.5,min:0,max:1,step:.01},mode:{type:"choice",values:["curve","linear"],default:"linear"},cap:{type:"choice",values:["butt","round","square"],default:"round"},join:{type:"choice",values:["bevel","miter","round"],default:"round"}},regression:{enabled:{type:"boolean",default:true},stroke:{type:"color",default:"#000"},strokeWidth:{type:"number",default:1,min:0,max:100,step:.5},strokeDasharray:{type:"text",default:"5 5"},opacity:{type:"number",default:.5,min:0,max:1,step:.01}}}),dimension:{name:{type:"NC",name:"name"},label:{type:"N",name:"label",desc:"text dedicated for showing in label. name will be used if omitted"},cat:{type:"C",name:"category"},size:{type:"R",name:"size"},x:{type:"R",name:"X coordinate"},y:{type:"R",name:"Y coordinate"},order:{type:"O",name:"Order"}},init:function(){var e,t,i=this;this.focusMode={enabled:false,names:[]};this.on("focus",function(t){var e;t==null&&(t={});i.focusMode.names=e=(Array.isArray(t.names)?t.names:[t.names]).filter(function(t){return t});i.focusMode.enabled=!!e.length;if(i.parsed){return i.render()}});this.dimed=function(t){return!((!(i.binding.cat!=null)||i.legend.isSelected(t.cat))&&!(i.focusMode.enabled&&!t.focused))};this.labelForce=getLabelForce(g);this.tint=e=new s.utils.tint;this.sim=g.forceSimulation();this.g=Object.fromEntries(["view","xaxis","yaxis","legend"].map(function(t){return[t,g.select(i.layout.getGroup(t))]}));this.gridX=this.g.view.append("g").attr("class","grid-x");this.gridY=this.g.view.append("g").attr("class","grid-y");this.regression=this.g.view.append("line").attr("opacity",0).attr("class","regression");this.trend=this.g.view.append("path").attr("opacity",0).attr("class","trend");this.trendAni=this.trend.append("animate").attr("attributeName","stroke-dashoffset").attr("repeatCount","indefinite").attr("dur","1s").attr("values","0;1").attr("times","0;1");this.scale=t={};this.yaxis=new s.utils.axis({layout:this.layout,name:"yaxis",direction:"left"});this.xaxis=new s.utils.axis({layout:this.layout,name:"xaxis",direction:"bottom"});this.line=g.line().defined(function(t){return!(isNaN(t.y)||isNaN(t.x))}).x(function(t){return i.scale.x(t.x)}).y(function(t){return i.scale.y(t.y)});this.legend=new s.utils.legend({layout:this.layout,name:"legend",root:this.root,shape:function(t){return g.select(this).attr("fill",e.get(t.key))}});this.legend.on("select",function(){i.bind();i.resize();return i.render()});return this.tip=new s.utils.tip({root:this.root,accessor:function(t){var e,r,a,n;e=t.evt;r=s.utils.format.from(i.cfg.tip.format)||".3s";if(!(e.target&&(a=g.select(e.target).datum()))){return null}n=isNaN(a.size)?"-":r(a.size)+""+(((i.binding||{}).size||{}).unit||"");return{name:[a.cat!=null?a.cat+" / ":"",a.name||"",a.order?" / "+a.order:""].join(""),value:i.binding.size?n:"-"}},range:function(){return i.layout.getNode("view").getBoundingClientRect()}})},destroy:function(){if(this.tip){return this.tip.destroy()}},parse:function(){this.parsed=this.data.map(function(t){var e;e=import$({},t);e.size=isNaN(t.size)?0:t.size;e.x=e._raw_x=isNaN(t.x)?0:t.x;e.y=e._raw_y=isNaN(t.y)?0:t.y;return e});this.parsed.sort(function(t,e){if(t.size<e.size){return-1}else if(t.size>e.size){return 1}else{return 0}});this.xlist=this.parsed.map(function(t){return t.x});this.ylist=this.parsed.map(function(t){return t.y});this.xlist.sort(function(t,e){if(t<e){return-1}else if(t>e){return 1}else{return 0}});return this.ylist.sort(function(t,e){if(t<e){return-1}else if(t>e){return 1}else{return 0}})},resize:function(){var t,r,e,a,x,n,i,s,o,p=this;this.parsed.map(function(t){return t.x=t._raw_x,t.y=t._raw_y,t});t=/(\d+)(\D+)/.exec((this.cfg.label||{}).cap);if(t){r=+t[1];if(t[2]==="﹪"){r=Math.round(r*this.parsed.length/100)}}else{r=this.parsed.length}this.parsed.map(function(t,e){return t.labelCapped=e>r});this.nodes=this.parsed.map(function(t){var e;e={data:t};t.node=e;return e});this.tint.set(this.cfg.palette);this.tip.toggle(((e=this.cfg).tip||(e.tip={})).enabled!=null?this.cfg.tip.enabled:true);this.line.curve(this.cfg.trend.mode==="curve"?g.curveCatmullRom:g.curveLinear);this.root.querySelector(".pdl-layout").classList.toggle("legend-bottom",this.cfg.legend.position==="bottom");this.root.querySelector(".pdl-layout").classList.toggle("xaxis-center",this.cfg.xaxis.center===true);this.root.querySelector(".pdl-layout").classList.toggle("yaxis-center",this.cfg.yaxis.center===true);this.legend.config(this.cfg.legend);a=!this.binding.cat?[]:Array.from(new Set(this.parsed.map(function(t){return t.cat}))).map(function(t){return{key:t,text:t}});this.legend.data(a);this.layout.update(false);x={y:g.extent(this.parsed.map(function(t){return t.y})),x:g.extent(this.parsed.map(function(t){return t.x})),s:g.extent(this.parsed.map(function(t){return t.size}))};if(this.cfg.alignRange){x.y=x.x=[Math.min.apply(Math,x.y.concat(x.x)),Math.max.apply(Math,x.y.concat(x.x))]}n=function(){var t,e,r,a,n,i,s,o,l,u,c,d,f,h,y;p.layout.update(false);t=p.layout.getBox("view");e=(p.cfg.dot.maxRadius||6)*t.width*.2/100;r=(p.cfg.dot.minRadius||0)*t.width*.2/100;a=e+p.cfg.dot.strokeWidth;p.scale.s=g.scaleSqrt().domain(x.s).range([r,e]);p.scale.y=function(){switch(this.cfg.yaxis.scale){case"log":return g.scaleSymlog().domain(x.y).range([t.height-a,a]);case"pr":return scalePr({clamp:true}).domain(this.ylist).range([t.height-a,a]);default:return g.scaleLinear().domain(x.y).range([t.height-a,a])}}.call(p);n=(i=Math.ceil(p.layout.getBox("yaxis").height/16))>2?i:2;s=p.scale.y.ticks((i=((o=p.cfg).xaxis||(o.xaxis={})).tick.count||4)<n?i:n);l=p.binding.y||{};p.yaxis.config(p.cfg.yaxis);p.yaxis.ticks(s);p.yaxis.scale(p.scale.y);u=p.cfg.yaxis.caption.text||l.name||l.key||"";if(l.unit){u+="("+l.unit+")"}p.yaxis.caption(u);p.yaxis.render();c=p.gridY.selectAll("line").data((p.cfg.yaxis.grid||{}).enabled?s:[]);c.exit().remove();c.enter().append("line");p.gridY.selectAll("line").attr("x1",a).attr("x2",t.width-a).attr("y1",function(t){return p.scale.y(t)}).attr("y2",function(t){return p.scale.y(t)}).attr("stroke",(p.cfg.yaxis.grid||{}).color)||"rgba(0,0,0,0.1)".attr("stroke-width",(p.cfg.yaxis.grid||{}).strokeWidth)||1..attr("stroke-dasharray",(p.cfg.yaxis.grid||{}).strokeDasharray)||"";p.scale.x=function(){switch(this.cfg.xaxis.scale){case"log":return g.scaleSymlog().domain(x.x).range([a,t.width-a]);case"pr":return scalePr({clamp:true}).domain(this.xlist).range([a,t.width-a]);default:return g.scaleLinear().domain(x.x).range([a,t.width-a])}}.call(p);n=(i=Math.ceil(p.layout.getBox("xaxis").width/80))>2?i:2;d=p.scale.x.ticks((i=((o=p.cfg).xaxis||(o.xaxis={})).tick.count||4)<n?i:n);f=p.binding.x||{};p.xaxis.config(p.cfg.xaxis);p.xaxis.ticks(d);p.xaxis.scale(p.scale.x);h=p.cfg.xaxis.caption.text||f.name||f.key||"";if(f.unit){h+="("+f.unit+")"}p.xaxis.caption(h);p.xaxis.render();y=p.gridX.selectAll("line").data((p.cfg.xaxis.grid||{}).enabled?d:[]);y.exit().remove();y.enter().append("line");return p.gridX.selectAll("line").attr("x1",function(t){return p.scale.x(t)}).attr("x2",function(t){return p.scale.x(t)}).attr("y1",a).attr("y2",t.height-a).attr("stroke",(p.cfg.xaxis.grid||{}).color)||"rgba(0,0,0,0.1)".attr("stroke-width",(p.cfg.xaxis.grid||{}).strokeWidth)||1..attr("stroke-dasharray",(p.cfg.xaxis.grid||{}).strokeDasharray)||""};for(i=0;i<2;++i){s=i;n()}this.parsed.map(function(t){var e;t.radius=p.binding.size!=null?(e=p.scale.s(t.size))>1?e:1:(e=p.cfg.dot.maxRadius/2)>1?e:1;t.px=p.scale.x(t.x);return t.py=p.scale.y(t.y)});this.nodes.map(function(t){return t.x=t.data.px,t.y=t.data.py,t});this.sim.nodes(this.nodes);o=this.layout.getBox("view");if((this.cfg.label||{}).enabled){this.sim.force("label",this.labelForce({bandMargin:2+this.cfg.dot.strokeWidth,rectPad:4,circlePad:2,kBand:1,kCollide:1,itRect:2,itCircle:1,kAlignx:.1,alignDeadband:1,canvasW:o.width,canvasH:o.height,boundsPad:4,kBounds:.9}));this.sim.alpha(1).alphaDecay(.01).velocityDecay(.3);return this.sim.restart()}},render:function(){var t,e,r,a,n,i,s,o,l,u,c,d,f,h,y,x,p,g,m,v=this;t=this.data,e=this.line,r=this.binding,a=this.scale,n=this.tint,i=this.legend,s=this.cfg,o=this.parsed;this.parsed.map(function(t){return t.focused=!v.focusMode.names.length?true:in$(t.name,v.focusMode.names)});l=this.g.view.selectAll("circle.data").data(this.parsed);l.exit().remove();l.enter().append("circle").attr("class","data").attr("r",0).attr("cx",function(t){return a.x(t.x)}).attr("cy",function(t){return a.y(t.y)}).attr("fill",function(t){return n.get(t.cat!=null?t.cat:"")}).attr("stroke",function(t){return s.dot.stroke}).attr("strokeWidth",function(t){return s.dot.strokeWidth});this.g.view.selectAll("circle.data").transition().duration(350).attr("r",function(t){return t.radius}).attr("cx",function(t){return a.x(t.x)}).attr("cy",function(t){return a.y(t.y)}).attr("fill",function(t){return n.get(t.cat!=null?t.cat:"")}).attr("opacity",function(t){var e;if(v.dimed(t)){return.1<(e=s.dot.opacity/2)?.1:e}else{return(e=s.dot.opacity)>.1?e:.1}}).attr("stroke",function(t){return s.dot.stroke}).attr("stroke-width",function(t){return s.dot.strokeWidth});u=this.g.view.selectAll("text.label").data((this.cfg.label||{}).enabled?this.parsed:[]);u.exit().remove();u.enter().append("text").attr("class",function(){var t,e;t=((s.label||{}).font||{}).family;return"label "+((e=t)?e.className||"":"")}).attr("dominant-baseline","middle").attr("text-anchor","middle").attr("transform",function(t,e){return"translate("+t.px+","+t.py+")"}).style("opacity",0).attr("font-size",0);this.g.view.selectAll("text.label").attr("font-size",((s.label||{}).font||{}).size||".75em").style("pointer-events",function(t){if(t.labelCapped){return"none"}else{return""}}).text(function(t,e){if(v.binding.label){return t.label||""}else{return t.name||""}}).each(function(t){var e;e=this.getBBox();t.node.w=e.width;return t.node.h=e.height});this.g.view.selectAll("text.label").transition().duration(350).style("opacity",function(t){if(v.dimed(t)||t.labelCapped){return 0}else{return 1}});c=_corr(this.parsed.filter(function(t,e){return!(r.cat!=null)||i.isSelected(t.cat)}));d=a.x.domain(),f=d[0],h=d[1];d=[f,h].map(function(t){return t*c[1]+c[0]}),y=d[0],x=d[1];if(y<a.y.domain()[0]){y=a.y.domain()[0];f=(y-c[0])/(c[1]||1)}if(x>a.y.domain()[1]){x=a.y.domain()[1];h=(x-c[0])/(c[1]||1)}d=[a.x(f),a.x(h),a.y(y),a.y(x)],f=d[0],h=d[1],y=d[2],x=d[3];p=isNaN(f)||isNaN(h)||isNaN(y)||isNaN(x)||!(c[0]||c[1])||!s.regression.enabled;this.regression.transition("regression").duration(350).attr("x1",p?0:f).attr("x2",p?0:h).attr("y1",p?0:y).attr("y2",p?0:x).attr("opacity",p?0:s.regression.opacity).attr("stroke",s.regression.stroke).attr("stroke-width",s.regression.strokeWidth).attr("stroke-dasharray",s.regression.strokeDasharray);g=o.map(function(t){return{x:t.x,y:t.y,order:t.order}});g.sort(function(t,e){if(t.order<e.order){return-1}else if(t.o>e.o){return 1}else{return 0}});this.trend.attr("d",function(){return e(g)}).attr("fill","none").attr("opacity",s.trend.enabled?1:0).attr("stroke",s.trend.stroke).attr("stroke-width",s.trend.strokeWidth).attr("stroke-dasharray",s.trend.strokeDasharray).attr("stroke-linecap",s.trend.cap).attr("stroke-linejoin",s.trend.join);m=s.trend.strokeDasharray.split(" ").filter(function(t){return t!=null}).reduce(function(t,e){return t+ +e},0);this.trendAni.attr("values",m+";0");this.legend.render();this.yaxis.render();this.xaxis.render();if((this.cfg.label||{}).enabled){return this.start()}},tick:function(){var t,e,r,a,n,i,s;t=this.data,e=this.line,r=this.binding,a=this.scale,n=this.tint,i=this.legend,s=this.cfg;if(!(this.cfg.label||{}).enabled){return}this._tick=(this._tick||0)+1;return this.g.view.selectAll("text.label").attr("transform",function(t){return"translate("+t.node.x+","+t.node.y+")"})}}};function import$(t,e){var r={}.hasOwnProperty;for(var a in e)if(r.call(e,a))t[a]=e[a];return t}function in$(t,e){var r=-1,a=e.length>>>0;while(++r<a)if(t===e[r])return true;return false}</script><div plug="layout"><div class="pdl-layout"><div data-type="layout"><div class="pdl-cell" data-name="yaxis">&nbsp;</div><div class="pdl-cell" data-name="view"></div><div class="pdl-cell"></div><div class="pdl-cell" data-name="xaxis">&nbsp;</div><div class="pdl-cell" data-name="legend">&nbsp;</div></div><div data-type="render"></div></div></div></div>